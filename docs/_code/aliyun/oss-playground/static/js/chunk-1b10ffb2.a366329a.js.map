{"version":3,"sources":["webpack:///./src/components/Upload.vue?784c","webpack:///./src/components/Upload.vue?9dce","webpack:///src/components/Upload.vue","webpack:///./src/components/Upload.vue?cbfb","webpack:///./src/components/Upload.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","startUpload","_v","ref","customUpload","staticRenderFns","callbackUrl","callbackBody","callbackBodyType","name","data","dialogImageUrl","dialogVisible","disabled","result","methods","$refs","myupload","submit","getSignatureAndUpload","param","component"],"mappings":"kHAAA,yBAA6c,EAAG,G,yCCAhd,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACA,EAAG,YAAY,CAACE,YAAY,QAAQC,MAAM,CAAC,KAAO,WAAWC,GAAG,CAAC,MAAQR,EAAIS,cAAc,CAACT,EAAIU,GAAG,UAAUN,EAAG,YAAY,CAACO,IAAI,WAAWL,YAAY,cAAcC,MAAM,CAAC,OAAS,IAAI,eAAc,EAAM,eAAeP,EAAIY,eAAe,CAACR,EAAG,YAAY,CAACE,YAAY,QAAQC,MAAM,CAAC,KAAO,YAAY,CAACP,EAAIU,GAAG,WAAW,IAAI,IAC5aG,EAAkB,G,gLCsBtB,sBACA,sBACA,kCACA,GACEC,YAAa,+CACbC,aACF,mFACEC,iBAAkB,qCAEpB,0BACA,GACEC,KAAM,UACNC,KAFF,WAGI,MAAO,CACLC,eAAgB,GAChBC,eAAe,EACfC,UAAU,EACVC,OAAQ,KAGZC,QAAS,CACP,sBADJ,SACA,8LAEA,wBAFA,UAEA,EAFA,OAGA,eAHA,wBAIA,gBACA,eACA,6BACA,uCACA,iDACA,iCACA,uCACA,wBACA,sCACA,uBAbA,UAeA,2BAfA,QAeA,EAfA,OAgBA,2BACA,iBACA,sBACA,yCAnBA,6DAuBA,kBAvBA,6DA2BI,aA5BJ,SA4BA,gMAEA,yBACA,uBAHA,UAEA,EAFA,OAKA,eACA,eANA,wBAOA,SACA,eACA,6BACA,wBAVA,oBAYA,iBAZA,QAYA,EAZA,OAaA,2BAbA,sDAeA,kBAfA,6DAmBA,kBAnBA,qEAsBId,YAlDJ,WAmDMR,KAAKuB,MAAMC,SAASC,UAEtBd,aArDJ,SAqDA,GACMX,KAAK0B,sBAAsBC,IAG7B,UAzDJ,SAyDA,+JACA,GACA,SACA,eACA,uDAJA,kBAQA,iBARA,gDCpGgV,I,wBCQ5UC,EAAY,eACd,EACA9B,EACAc,GACA,EACA,KACA,KACA,MAIa,aAAAgB,E","file":"js/chunk-1b10ffb2.a366329a.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Upload.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Upload.vue?vue&type=style&index=0&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-button',{staticClass:\"mg-bt\",attrs:{\"type\":\"primary\"},on:{\"click\":_vm.startUpload}},[_vm._v(\"点击上传\")]),_c('el-upload',{ref:\"myupload\",staticClass:\"upload-demo\",attrs:{\"action\":\"#\",\"auto-upload\":false,\"http-request\":_vm.customUpload}},[_c('el-button',{staticClass:\"mg-bt\",attrs:{\"type\":\"primary\"}},[_vm._v(\"添加文件\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div>\n    <el-button type=\"primary\" @click=\"startUpload\" class=\"mg-bt\"\n      >点击上传</el-button\n    >\n    <el-upload\n      class=\"upload-demo\"\n      action=\"#\"\n      :auto-upload=\"false\"\n      ref=\"myupload\"\n      :http-request=\"customUpload\"\n    >\n      <el-button type=\"primary\" class=\"mg-bt\">添加文件</el-button>\n    </el-upload>\n  </div>\n</template>   \n\n\n<script>\n/* eslint-disable */\nimport Vue from \"vue\";\nimport { Upload, Button, Message } from \"element-ui\";\nimport axios from \"axios\";\nVue.use(Upload);\nVue.use(Button);\nlet serverUrl = \"http://192.168.0.22:8080/\";\nconst callbackJson = {\n  callbackUrl: \"http://1f632a59ba92.ngrok.io/alioss/callback\",\n  callbackBody:\n    \"bucket=${bucket}&object=${object}&etag=${etag}&size=${size}&mimeType=${mimeType}\",\n  callbackBodyType: \"application/x-www-form-urlencoded\",\n};\nlet callbackBase64Str = btoa(JSON.stringify(callbackJson));\nexport default {\n  name: \"up-load\",\n  data() {\n    return {\n      dialogImageUrl: \"\",\n      dialogVisible: false,\n      disabled: false,\n      result: {},\n    };\n  },\n  methods: {\n    async getSignatureAndUpload(param) {\n      try {\n        let result = await axios.get(serverUrl + \"oss/upload\");\n        if (result.status === 200) {\n          this.result = result.data;\n          let formData = new FormData();\n          formData.append(\"name\", param.file.name);\n          formData.append(\"key\", result.data.dir + param.file.name);\n          formData.append(\"OSSAccessKeyId\", result.data.OSSAccessKeyId); //accessKeyId\n          formData.append(\"policy\", result.data.policy); //policy\n          formData.append(\"Signature\", result.data.signature); //签名\n          formData.append(\"file\", param.file);\n          formData.append(\"success_action_status\", 200); //成功后返回的操作码\n          formData.append(\"callback\", callbackBase64Str); // 不生效？？？？\n\n          let res = await this.uploadOSS(formData, result.data.host);\n          console.log(\"uploadOSS\", res);\n          if (res.status === 200) {\n            Message.success(\"文件上传成功\");\n            this.$parent.$refs.download.getFileLists();\n          }\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    },\n    // node 服务\n    async getUploadUrl(param) {\n      try {\n        let result = await axios.post(serverUrl + \"oss/upload\", {\n          fileName: param.file.name,\n        });\n        console.log(result);\n        if (result.status === 200) {\n          let uploadUrl = result.data;\n          let formData = new FormData();\n          formData.append(\"name\", param.file.name);\n          formData.append(\"file\", param.file);\n          try {\n            let res = await this.uploadOSS(formData, uploadUrl);\n            console.log(\"uploadOSS\", res);\n          } catch (e) {\n            console.log(e);\n          }\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    },\n    startUpload() {\n      this.$refs.myupload.submit();\n    },\n    customUpload(param) {\n      this.getSignatureAndUpload(param);\n      // this.getUploadUrl(param);\n    },\n    async uploadOSS(formData, url) {\n      const config = {\n        headers: {\n          \"Content-Type\":\n            \"multipart/form-data;boundary=\" + new Date().getTime(),\n          // \"x-oss-callback\": callbackBase64Str,\n        },\n      };\n      return axios.post(url, formData, config);\n    },\n  },\n};\n</script>\n<style>\n.mg-bt {\n  margin-bottom: 20px;\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Upload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Upload.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Upload.vue?vue&type=template&id=39bbbf7f&\"\nimport script from \"./Upload.vue?vue&type=script&lang=js&\"\nexport * from \"./Upload.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Upload.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}