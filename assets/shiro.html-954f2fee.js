import{_ as n,o as a,c as s,e as t}from"./app-4d1d3ef4.js";const e={},i=t(`<h2 id="apache-shiro-terminology" tabindex="-1"><a class="header-anchor" href="#apache-shiro-terminology" aria-hidden="true">#</a> Apache Shiro Terminology</h2><p>Apache Shiro is a powerful and flexible open-source security framework that cleanly handles <strong>authentication</strong>, ** authorization**, enterprise <strong>session management</strong> and <strong>cryptography</strong>.Shiro’s architecture has 3 primary concepts: the Subject, SecurityManager and Realms</p><ul><li><p>Subject: anything that is currently interacting with the software. Subject instances are all bound to (and require) a SecurityManager. When you interact with a Subject, those interactions translate to subject-specific interactions with the SecurityManager.</p></li><li><p>SecurityManager: The SecurityManager is the heart of Shiro’s architecture, it is important to realize that when you interact with a Subject, it is really the SecurityManager behind the scenes that does all the heavy lifting for any Subject security operation.</p></li><li><p>Realms: Realms act as the ‘bridge’ or ‘connector’ between Shiro and your application’s security data. In this sense a Realm is essentially a security-specific DAO: it encapsulates connection details for data sources and makes the associated data available to Shiro as needed. When configuring Shiro, you must specify at least one Realm to use for authentication and/or authorization. The SecurityManager may be configured with multiple Realms, but at least one is required.</p></li><li><p>Authentication: Authentication is the process of verifying a Subject’s identity</p></li><li><p>Authorization: Authorization, also known as Access Control, is the process of determining if a user/Subject is allowed to do something or not</p></li><li><p>Cipher: A cipher is an algorithm for performing encryption or decryption.</p></li><li><p>Credential A Credential is a piece of information(such as a password or a PGP key) that verifies the identity of a user/Subject. One (or more) credentials are submitted along with Principal(s) during an authentication attempt to verify that the user/Subject submitting them is actually the associated user.</p></li><li><p>Cryptography: Cryptography is the practice of protecting information from undesired access by hiding it or converting it into nonsense so no one else can read it. Shiro focuses on two core elements of Cryptography: ciphers that encrypt data like email using a public or private key, and hashes (aka message digests) that irreversibly encrypt data like passwords.</p></li><li><p>Hash: A Hash function is a one-way, irreversible conversion of an input source, sometimes called the message, into an encoded hash value, sometimes called the message digest. It is often used for passwords, digital fingerprints, or data with an underlying byte array.</p></li><li><p>Principal: A Principal is any identifying attribute of an application user (Subject) (a username, a surname, a given name, a social security number, a user ID)</p></li><li><p>Session: A Session is a stateful data context associated with a single user/Subject who interacts with a software system over a period of time.Sessions are terminated when the user/Subject logs out of the application or when it times out due to inactivity.</p></li></ul><h2 id="shiro-api" tabindex="-1"><a class="header-anchor" href="#shiro-api" aria-hidden="true">#</a> Shiro api</h2><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Subject</span> currentUser <span class="token operator">=</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前用户</span>
<span class="token class-name">Session</span> session <span class="token operator">=</span> currentUser<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取当前会话</span>
currentUser<span class="token punctuation">.</span><span class="token function">isAuthenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 当前用户是否已经认证过</span>
<span class="token class-name">UsernamePasswordToken</span> token <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordToken</span><span class="token punctuation">(</span><span class="token string">&quot;lee&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;123456&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
currentUser<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 登录</span>
currentUser<span class="token punctuation">.</span><span class="token function">getPrincipal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// print their identifying principal (in this case, a username)</span>
currentUser<span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">&quot;admin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
currentUser<span class="token punctuation">.</span><span class="token function">isPermitted</span><span class="token punctuation">(</span><span class="token string">&quot;sys:getUsers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
currentUser<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//removes all identifying information and invalidates their session too </span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="authentication-authorization-guide-with-apache-shiro" tabindex="-1"><a class="header-anchor" href="#authentication-authorization-guide-with-apache-shiro" aria-hidden="true">#</a> Authentication|Authorization Guide with Apache Shiro</h2><ul><li>step1: Collect the subject’s principals and credentials</li><li>step2: Submit the principals and credentials to an authentication system.</li><li>step3: Allow access, retry authentication, or block access</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">UsernamePasswordToken</span> token <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordToken</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// step1</span>
<span class="token comment">// step2: Authenticate the subject by passing the user name and password token into the login method</span>
<span class="token class-name">Subject</span> currentUser <span class="token operator">=</span> <span class="token class-name">SecurityUtils</span><span class="token punctuation">.</span><span class="token function">getSubject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
currentUser<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
    currentUser<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// step3</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>currentUser<span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">&quot;administrator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// show a special button</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// don’t show the button</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span> <span class="token class-name">AuthenticationException</span> ae <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//unexpected error</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="realm-authentication" tabindex="-1"><a class="header-anchor" href="#realm-authentication" aria-hidden="true">#</a> Realm Authentication</h2><h3 id="handling-supported-authenticationtokens" tabindex="-1"><a class="header-anchor" href="#handling-supported-authenticationtokens" aria-hidden="true">#</a> Handling supported AuthenticationTokens</h3><p>a Realm supports a submitted <code>AuthenticationToken</code>, the <code>Authenticator</code> will call the Realm’s <code>getAuthenticationInfo(token)</code> method. This effectively represents an authentication attempt with the Realm’s backing data source. The method, in order:</p><ul><li><p>Inspects the token for the identifying principal (account identifying information)</p></li><li><p>Based on the principal, looks up corresponding account data in the data source</p></li><li><p>Ensures that the token’s supplied credentials matches those stored in the data store</p></li><li><p>If the credentials match, an <code>AuthenticationInfo</code> instance is returned that encapsulates the account data in a format Shiro understands</p></li><li><p>If the credentials DO NOT match, an <code>AuthenticationException</code> is thrown</p></li></ul><p>Implementing <code>Realm</code> interface directly might be time consuming and error prone. Most people choose to subclass the <code>AuthorizingRealm</code> abstract class instead of starting from scratch. This class implements common authentication and authorization workflow to save you time and effort.</p><h3 id="credentials-matching" tabindex="-1"><a class="header-anchor" href="#credentials-matching" aria-hidden="true">#</a> Credentials Matching</h3><h2 id="integrate-shiro-with-spring-boot" tabindex="-1"><a class="header-anchor" href="#integrate-shiro-with-spring-boot" aria-hidden="true">#</a> integrate shiro with Spring boot</h2><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.shiro<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>shiro-spring-boot-web-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.10.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>In a web application, all Shiro-accessible web requests must go through a main Shiro Filter.This filter itself is extremely powerful, allowing for ad-hoc custom filter chains to be executed based on any URL path expression.</li></ul>`,17),o=[i];function c(p,l){return a(),s("div",null,o)}const u=n(e,[["render",c],["__file","/home/runner/work/vuepress_blog/vuepress_blog/docs/.vuepress/.temp/pages/java/shiro.html.vue"]]);export{u as default};
